{
    "num_layers": 24,
    "encoder_num_layers": 24,
    "decoder_num_layers": null,
    "hidden_size": 1024,
    "ffn_hidden_size": 4096,
    "num_attention_heads": 16,
    "kv_channels": 64,
    "max_position_embeddings": 512,
    "use_rotary_position_embeddings": false,
    "rotary_percent": 1.0,
    "add_position_embedding": true,
    "make_vocab_size_divisible_by": 128,
    "layernorm_epsilon": 1e-05,
    "apply_layernorm_1p": false,
    "apply_residual_connection_post_layernorm": false,
    "openai_gelu": false,
    "squared_relu": false,
    "swiglu": false,
    "onnx_safe": null,
    "bert_binary_head": true,
    "num_experts": null,
    "untie_embeddings_and_output_weights": false,
    "attention_dropout": 0.1,
    "hidden_dropout": 0.1,
    "weight_decay": 0.01,
    "start_weight_decay": 0.01,
    "end_weight_decay": 0.01,
    "weight_decay_incr_style": "constant",
    "clip_grad": 1.0,
    "adam_beta1": 0.9,
    "adam_beta2": 0.999,
    "adam_eps": 1e-08,
    "sgd_momentum": 0.9,
    "micro_batch_size": 1,
    "global_batch_size": 768,
    "rampup_batch_size": null,
    "recompute_granularity": null,
    "distribute_saved_activations": false,
    "recompute_method": null,
    "recompute_num_layers": 1,
    "train_iters": null,
    "train_samples": 25000000,
    "log_interval": 100,
    "exit_interval": null,
    "exit_duration_in_mins": null,
    "exit_signal_handler": false,
    "tensorboard_dir": null,
    "masked_softmax_fusion": true,
    "bias_gelu_fusion": true,
    "bias_dropout_fusion": true,
    "use_flash_attn": false,
    "add_bias_linear": true,
    "optimizer": "adam",
    "dataloader_type": "single",
    "async_tensor_model_parallel_allreduce": false,
    "no_persist_layer_norm": false,
    "sequence_parallel": false,
    "gradient_accumulation_fusion": false,
    "seed": 1234,
    "retro_gpt_seed": 1234,
    "data_parallel_random_init": false,
    "init_method_std": 0.02,
    "init_method_xavier_uniform": false,
    "lr": 0.0001,
    "lr_decay_style": "linear",
    "lr_decay_iters": null,
    "lr_decay_samples": 0,
    "lr_warmup_fraction": null,
    "lr_warmup_iters": 0,
    "lr_warmup_samples": 0,
    "min_lr": 1e-05,
    "override_opt_param_scheduler": false,
    "use_checkpoint_opt_param_scheduler": false,
    "save": null,
    "save_interval": null,
    "no_save_optim": null,
    "no_save_rng": null,
    "load": "/lustre/fsw/adlr/adlr-nlp/lmcafee/data/bert-336m-corpus/checkpoints-v1",
    "no_load_optim": true,
    "no_load_rng": null,
    "finetune": false,
    "perform_initialization": true,
    "use_checkpoint_args": false,
    "exit_on_missing_checkpoint": true,
    "fp16": true,
    "bf16": false,
    "loss_scale": null,
    "initial_loss_scale": 4294967296,
    "min_loss_scale": 1.0,
    "loss_scale_window": 1000,
    "hysteresis": 2,
    "fp32_residual_connection": false,
    "apply_query_key_layer_scaling": true,
    "attention_softmax_in_fp32": false,
    "accumulate_allreduce_grads_in_fp32": false,
    "fp16_lm_cross_entropy": false,
    "tensor_model_parallel_size": 1,
    "pipeline_model_parallel_size": 1,
    "pipeline_model_parallel_split_rank": null,
    "num_layers_per_virtual_pipeline_stage": null,
    "distributed_backend": "nccl",
    "distributed_timeout_minutes": 600,
    "DDP_impl": "local",
    "use_contiguous_buffers_in_local_ddp": true,
    "scatter_gather_tensors_in_pipeline": true,
    "use_ring_exchange_p2p": false,
    "local_rank": 0,
    "lazy_mpu_init": null,
    "use_cpu_initialization": null,
    "empty_unused_memory_level": 0,
    "standalone_embedding_stage": false,
    "use_distributed_optimizer": false,
    "eval_iters": 32,
    "retro_gpt_eval_iters": 32,
    "eval_interval": 1260,
    "retro_gpt_eval_interval": 1260,
    "data_path": [
        "0.01920",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Books3_shuf_text_document",
        "0.01602",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/OpenWebText2_shuf_text_document",
        "0.00751",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/StackExchange_shuf_text_document",
        "0.00324",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/PubMedAbs_shuf_text_document",
        "0.00653",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Wikipedia_shuf_text_document",
        "0.00193",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Gutenberg_shuf_text_document",
        "0.00117",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/BookCorpus2_shuf_text_document",
        "0.00023",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/NIHExporter_shuf_text_document",
        "0.01143",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/ArXiv_shuf_text_document",
        "0.00366",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Stories_shuf_text_document",
        "0.03992",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/BigScience/BigScience_shuf_text_document",
        "0.04768",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/Reddit-Plus/Reddit_all_dialogue_shuf_text_document",
        "0.07199",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-NEWS/CC-NEWS_shuf_text_document",
        "0.02180",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Pile-CC_shuf_text_document",
        "0.07633",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2020-50/CC-MAIN-2020-50_shuf_text_document",
        "0.07644",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2022-40/CC-MAIN-2022-40_00_shuf_text_document",
        "0.07644",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2022-40/CC-MAIN-2022-40_01_shuf_text_document",
        "0.09414",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2019-35/CC-MAIN-2019-35_shuf_text_document",
        "0.03890",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/CC-2021-04_shuf_text_document",
        "0.08544",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/mc4-en_1T-url/mc4-en_shuf_text_document"
    ],
    "retro_gpt_data_path": [
        "0.01920",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Books3_shuf_text_document",
        "0.01602",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/OpenWebText2_shuf_text_document",
        "0.00751",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/StackExchange_shuf_text_document",
        "0.00324",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/PubMedAbs_shuf_text_document",
        "0.00653",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Wikipedia_shuf_text_document",
        "0.00193",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Gutenberg_shuf_text_document",
        "0.00117",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/BookCorpus2_shuf_text_document",
        "0.00023",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/NIHExporter_shuf_text_document",
        "0.01143",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/ArXiv_shuf_text_document",
        "0.00366",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Stories_shuf_text_document",
        "0.03992",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/BigScience/BigScience_shuf_text_document",
        "0.04768",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/Reddit-Plus/Reddit_all_dialogue_shuf_text_document",
        "0.07199",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-NEWS/CC-NEWS_shuf_text_document",
        "0.02180",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/Pile-CC_shuf_text_document",
        "0.07633",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2020-50/CC-MAIN-2020-50_shuf_text_document",
        "0.07644",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2022-40/CC-MAIN-2022-40_00_shuf_text_document",
        "0.07644",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2022-40/CC-MAIN-2022-40_01_shuf_text_document",
        "0.09414",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/CC-MAIN-2019-35/CC-MAIN-2019-35_shuf_text_document",
        "0.03890",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/MTNLG/CC-2021-04_shuf_text_document",
        "0.08544",
        "/lustre/fsw/adlr/adlr-nlp/boxinw/retro/data/english/mc4-en_1T-url/mc4-en_shuf_text_document"
    ],
    "split": "98,2,0",
    "retro_gpt_split": "98,2,0",
    "split_constraint": ["99,1,0", "98,2,0"],
    "train_data_path": null,
    "valid_data_path": null,
    "test_data_path": null,
    "vocab_file": "/lustre/fsw/adlr/adlr-nlp/lmcafee/data/bert-336m-corpus/misc/bert_vocab.txt",
    "merge_file": null,
    "vocab_extra_ids": 0,
    "seq_length": 512,
    "encoder_seq_length": 512,
    "decoder_seq_length": null,
    "retriever_seq_length": 256,
    "sample_rate": 1.0,
    "mask_prob": 0.15,
    "short_seq_prob": 0.1,
    "mmap_warmup": false,
    "retro_gpt_mmap_warmup": false,
    "num_workers": 2,
    "tokenizer_type": "BertWordPieceLowerCase",
    "tokenizer_model": null,
    "data_impl": "mmap",
    "retro_gpt_data_impl": "mmap",
    "reset_position_ids": false,
    "reset_attention_mask": false,
    "eod_mask_loss": false,
    "adlr_autoresume": false,
    "adlr_autoresume_interval": 1000,
    "ict_head_size": null,
    "biencoder_projection_dim": 0,
    "biencoder_shared_query_context_model": false,
    "ict_load": null,
    "bert_load": null,
    "titles_data_path": null,
    "query_in_block_prob": 0.1,
    "use_one_sent_docs": false,
    "evidence_data_path": null,
    "retriever_report_topk_accuracies": [],
    "retriever_score_scaling": false,
    "block_data_path": null,
    "embedding_path": null,
    "indexer_batch_size": 128,
    "indexer_log_interval": 1000,
    "num_classes": 1000,
    "img_h": 224,
    "img_w": 224,
    "num_channels": 3,
    "patch_dim": 16,
    "classes_fraction": 1.0,
    "data_per_class_fraction": 1.0,
    "data_sharding": false,
    "head_lr_mult": 1.0,
    "vision_pretraining": false,
    "vision_pretraining_type": "classify",
    "vision_backbone_type": "vit",
    "swin_backbone_type": "tiny",
    "mask_type": "random",
    "mask_factor": 1.0,
    "iter_per_epoch": 1250,
    "dino_local_img_size": 96,
    "dino_local_crops_number": 10,
    "dino_head_hidden_size": 2048,
    "dino_bottleneck_size": 256,
    "dino_freeze_last_layer": 1,
    "dino_norm_last_layer": false,
    "dino_warmup_teacher_temp": 0.04,
    "dino_teacher_temp": 0.07,
    "dino_warmup_teacher_temp_epochs": 30,
    "log_params_norm": false,
    "log_num_zeros_in_grad": false,
    "timing_log_level": 0,
    "barrier_with_L1_time": true,
    "timing_log_option": "minmax",
    "tensorboard_log_interval": 1,
    "tensorboard_queue_size": 1000,
    "log_timers_to_tensorboard": false,
    "log_batch_size_to_tensorboard": false,
    "log_learning_rate_to_tensorboard": true,
    "log_loss_scale_to_tensorboard": true,
    "log_validation_ppl_to_tensorboard": false,
    "log_memory_to_tensorboard": false,
    "log_world_size_to_tensorboard": false,
    "inference_batch_times_seqlen_threshold": 512,
    "max_tokens_to_oom": 12000,
    "output_bert_embeddings": true,
    "bert_embedder_type": "megatron",
    "fp8_e4m3": false,
    "fp8_hybrid": false,
    "fp8_wgrad": true,
    "fp8_margin": 0,
    "fp8_interval": 1,
    "transformer_impl": "local",
    "fp8_amax_history_len": 1,
    "fp8_amax_compute_algo": "most_recent",
    "retro_workdir": "/lustre/fsw/adlr/adlr-nlp/boxinw/next-llm/",
    "retro_add_retriever": false,
    "retro_cyclic_train_iters": null,
    "retro_encoder_layers": 2,
    "retro_encoder_hidden_dropout": 0.1,
    "retro_encoder_attention_dropout": 0.1,
    "retro_num_neighbors": 2,
    "retro_num_retrieved_chunks": 2,
    "retro_return_doc_ids": true,
    "retro_tasks": [
        "query-pretraining-neighbors"
    ],
    "retro_block_size": 100000,
    "retro_doc_block_size": 100000,
    "retro_gpt_tokenizer_type": "GPTSentencePieceTokenizer",
    "retro_gpt_vocab_file": null,
    "retro_gpt_merge_file": null,
    "retro_gpt_tokenizer_model": "/lustre/fsw/adlr/adlr-nlp/adlr-nlp-sharing/nvllm-1.1t/utils/mt_nlg_plus_multilingual_ja_zh_the_stack_frac_015_256k.model",
    "retro_gpt_seq_length": 4096,
    "retro_gpt_global_batch_size": 768,
    "retro_gpt_chunk_length": 64,
    "retro_bert_vocab_file": "/lustre/fsw/adlr/adlr-nlp/lmcafee/data/bert-336m-corpus/misc/bert_vocab.txt",
    "retro_bert_tokenizer_type": "BertWordPieceLowerCase",
    "retro_bert_batch_size": 128,
    "retro_bert_max_chunk_length": 256,
    "retro_index_nfeats": 1024,
    "retro_index_type": "faiss-par-add",
    "retro_index_str": "OPQ64_128,IVF4194304_HNSW32,PQ64",
    "retro_index_ntrain": 600000000,
    "retro_index_train_load_fraction": 0.66667,
    "retro_index_add_load_fraction": 1.0,
    "retro_index_delete_training_embeddings": false,
    "retro_index_delete_added_codes": false,
    "retro_query_ef_search": 32,
    "retro_query_nprobe": 4096,
    "retro_query_num_neighbors_query": 200,
    "retro_query_num_neighbors_save": 20,
    "rank": 0,
    "world_size": 1,
    "transformer_pipeline_model_parallel_size": 1,
    "data_parallel_size": 1,
    "virtual_pipeline_model_parallel_size": null,
    "params_dtype": "torch.float16",
    "consumed_train_samples": 0,
    "consumed_valid_samples": 0,
    "variable_seq_lengths": false,
    "padded_vocab_size": 30592
}