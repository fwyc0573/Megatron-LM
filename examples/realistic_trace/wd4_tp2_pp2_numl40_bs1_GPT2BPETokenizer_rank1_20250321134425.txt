rank:1:get_batch(stage_id=0,batch_id=0,mg_state=warmup,duration=1.3,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11491169328.09,sub_operations=['trace_src_func=_broadcast,duration=0.72,timestamp=11491169327.59,input__shape=[1, 4096],input__dtype=torch.int64,func_name=tokens,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.19,timestamp=11491169327.86,input__shape=[1, 1, 4096, 4096],input__dtype=torch.bool,func_name=attention_mask,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.12,timestamp=11491169328.05,input__shape=[1, 4096],input__dtype=torch.int64,func_name=position_ids,group=tp,comm_func=broadcast'])
rank:1:forward_step(stage_id=0,batch_id=0,mg_state=warmup,duration=147.9,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11491169476.04,sub_operations=['trace_src_func=_reduce,duration=0.36,timestamp=11491169328.99,input__shape=[1, 4096, 5120],input__dtype=torch.float16,func_name=embedding_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169332.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169336.46,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169339.7,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11491169343.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11491169346.91,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169350.86,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.52,timestamp=11491169354.25,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.42,timestamp=11491169358.26,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.54,timestamp=11491169361.65,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.58,timestamp=11491169365.81,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.41,timestamp=11491169369.09,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.52,timestamp=11491169373.21,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169376.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.45,timestamp=11491169380.48,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11491169383.69,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.53,timestamp=11491169387.81,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.39,timestamp=11491169391.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169395.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169398.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169402.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.4,timestamp=11491169405.71,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169409.72,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169413.03,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169417.07,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.41,timestamp=11491169420.42,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169424.45,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.4,timestamp=11491169427.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169431.83,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169435.12,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169439.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.39,timestamp=11491169442.46,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169446.5,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169449.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169453.8,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169457.08,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.4,timestamp=11491169461.15,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169464.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169468.43,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11491169471.77,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.4,timestamp=11491169475.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce'])
rank:1:send_forward(stage_id=0,batch_id=0,mg_state=warmup,duration=0.36,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=11491169476.51,sub_operations=[])
rank:1:recv_backward(stage_id=0,batch_id=0,mg_state=cooldown,duration=433.42,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=11491169910.04,sub_operations=[])
rank:1:backward_step(stage_id=0,batch_id=0,mg_state=cooldown,duration=271.21,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11491170181.33,sub_operations=['trace_src_func=normlinear_bwd_async,duration=1.65,timestamp=11491169917.22,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.36,timestamp=11491169922.81,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.65,timestamp=11491169929.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.33,timestamp=11491169935.22,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.66,timestamp=11491169942.11,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.35,timestamp=11491169947.7,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.7,timestamp=11491169954.63,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.4,timestamp=11491169960.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.71,timestamp=11491169967.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.41,timestamp=11491169973.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.77,timestamp=11491169980.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.38,timestamp=11491169986.64,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491169994.02,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491169999.98,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170007.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170013.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170020.86,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.4,timestamp=11491170026.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170034.3,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170040.26,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170047.72,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.4,timestamp=11491170053.69,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170061.15,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170067.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.79,timestamp=11491170074.61,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.4,timestamp=11491170080.55,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491170087.95,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.38,timestamp=11491170093.88,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491170101.27,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.38,timestamp=11491170107.19,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.77,timestamp=11491170114.59,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170120.52,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.77,timestamp=11491170127.92,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170133.86,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491170141.26,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11491170147.19,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491170154.58,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.41,timestamp=11491170160.54,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.78,timestamp=11491170167.93,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.42,timestamp=11491170173.89,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce'])
rank:1:dp_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=7.74,description=model_chunk.finish_grad_sync(), All-reduce / reduce-scatter across DP replicas,group_kind=dp,input__shape=[3296778240],input__dtype=torch.float16,timestamp=11491170189.19,sub_operations=[])
rank:1:ep_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=2.06,description=_allreduce_word_embedding_grads,group_kind=ep,input__shape=[25216, 5120],input__dtype=torch.float16,timestamp=11491170191.32,sub_operations=[])
rank:1:optimizer_step(stage_id=0,batch_id=0,mg_state=finalize,duration=37.65,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11491170229.8,sub_operations=[])
