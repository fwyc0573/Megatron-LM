rank:3:recv_forward(stage_id=1,batch_id=0,mg_state=help,duration=147.18,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=11495994669.6,sub_operations=[])
rank:3:get_batch(stage_id=1,batch_id=0,mg_state=steady,duration=2.14,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11495994673.01,sub_operations=['trace_src_func=_broadcast,duration=1.47,timestamp=11495994672.53,input__shape=[1, 4096],input__dtype=torch.int64,func_name=labels,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.09,timestamp=11495994672.7,input__shape=[1, 4096],input__dtype=torch.float32,func_name=loss_mask,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.2,timestamp=11495994672.97,input__shape=[1, 1, 4096, 4096],input__dtype=torch.bool,func_name=attention_mask,group=tp,comm_func=broadcast'])
rank:3:forward_step(stage_id=1,batch_id=0,mg_state=steady,duration=150.94,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11495994824.0,sub_operations=['trace_src_func=allreduce,duration=0.36,timestamp=11495994676.34,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=11495994680.31,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994683.51,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994687.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.94,timestamp=11495994691.18,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.7,timestamp=11495994695.41,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.44,timestamp=11495994698.71,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.5,timestamp=11495994702.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.49,timestamp=11495994706.06,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.45,timestamp=11495994710.02,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.44,timestamp=11495994713.27,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.41,timestamp=11495994717.21,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994720.43,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.42,timestamp=11495994724.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994727.56,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.58,timestamp=11495994731.66,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994734.86,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994738.74,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994741.9,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994745.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994748.99,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994752.89,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994756.06,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994759.94,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.47,timestamp=11495994763.24,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994767.15,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994770.32,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.38,timestamp=11495994774.2,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.38,timestamp=11495994777.41,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.45,timestamp=11495994781.38,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994784.58,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994788.46,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.41,timestamp=11495994791.71,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994795.59,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=11495994798.78,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994802.66,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994805.83,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994809.72,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.41,timestamp=11495994812.93,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=11495994816.82,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.06,timestamp=11495994821.78,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_1,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.02,timestamp=11495994822.45,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_2,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.02,timestamp=11495994823.29,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_3,group=tp,comm_func=allreduce'])
rank:3:loss_func(stage_id=1,batch_id=0,mg_state=steady,duration=0.44,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=11495994824.53,sub_operations=['trace_src_func=allreduce,duration=0.07,timestamp=11495994824.4,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:3:backward_step(stage_id=1,batch_id=0,mg_state=steady,duration=253.49,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11495995078.17,sub_operations=['trace_src_func=embedding_bwd_async,duration=3.93,timestamp=11495994833.8,input__shape=[4096, 1, 5120],input__dtype=torch.float16,func_name=embedding_bwd_async,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994840.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.32,timestamp=11495994846.03,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994852.74,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.37,timestamp=11495994858.25,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994864.96,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.39,timestamp=11495994870.48,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994877.18,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.37,timestamp=11495994882.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994889.38,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.36,timestamp=11495994894.86,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994901.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.35,timestamp=11495994907.05,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.61,timestamp=11495994913.76,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.41,timestamp=11495994919.29,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994925.99,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.41,timestamp=11495994931.53,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994938.24,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.36,timestamp=11495994943.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994950.43,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.4,timestamp=11495994955.96,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994962.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.33,timestamp=11495994968.12,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.61,timestamp=11495994974.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.32,timestamp=11495994980.28,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495994986.98,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.35,timestamp=11495994992.46,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.61,timestamp=11495994999.17,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.33,timestamp=11495995004.63,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495995011.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.34,timestamp=11495995016.8,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.62,timestamp=11495995023.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.33,timestamp=11495995029.06,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.62,timestamp=11495995035.83,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.31,timestamp=11495995041.3,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495995048.01,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.31,timestamp=11495995053.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495995060.14,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.31,timestamp=11495995065.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.6,timestamp=11495995072.28,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.27,timestamp=11495995077.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce'])
rank:3:send_backward(stage_id=1,batch_id=0,mg_state=steady,duration=0.35,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=11495995078.71,sub_operations=[])
rank:3:dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=7.69,description=model_chunk.finish_grad_sync(), All-reduce / reduce-scatter across DP replicas,group_kind=dp,input__shape=[3275816960],input__dtype=torch.float16,timestamp=11495995086.46,sub_operations=[])
rank:3:ep_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=256.16,description=_allreduce_word_embedding_grads,group_kind=ep,input__shape=[25216, 5120],input__dtype=torch.float16,timestamp=11495995342.71,sub_operations=[])
rank:3:optimizer_step(stage_id=1,batch_id=0,mg_state=finalize,duration=105.33,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11495995449.27,sub_operations=[])
