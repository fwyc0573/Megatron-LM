rank:2:recv_forward(stage_id=1,batch_id=0,mg_state=help,duration=248.24,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=16109046348.7,sub_operations=[])
rank:2:get_batch(stage_id=1,batch_id=0,mg_state=steady,duration=11.13,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=16109046361.39,sub_operations=['trace_src_func=_broadcast,duration=0.02,timestamp=16109046360.93,input__shape=[1, 4096],input__dtype=torch.int64,func_name=labels,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.09,timestamp=16109046361.14,input__shape=[1, 4096],input__dtype=torch.float32,func_name=loss_mask,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.12,timestamp=16109046361.33,input__shape=[1, 1, 4096, 4096],input__dtype=torch.bool,func_name=attention_mask,group=tp,comm_func=broadcast'])
rank:2:forward_step(stage_id=1,batch_id=0,mg_state=steady,duration=161.05,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=16109046522.52,sub_operations=['trace_src_func=allreduce,duration=0.35,timestamp=16109046365.1,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046369.59,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046373.05,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046377.42,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.39,timestamp=16109046380.89,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046385.22,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046388.62,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046392.99,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046396.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046400.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046404.15,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046408.5,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046411.91,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046416.25,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046419.68,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046424.03,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046427.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046431.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046435.2,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046439.56,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046442.98,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046447.3,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046450.74,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046455.07,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046458.5,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046462.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046466.23,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046470.57,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046473.99,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046478.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.35,timestamp=16109046481.77,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046486.11,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046489.51,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046493.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046497.27,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046501.62,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046505.04,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.36,timestamp=16109046509.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.39,timestamp=16109046512.8,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.37,timestamp=16109046517.14,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.04,timestamp=16109046520.71,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_1,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.14,timestamp=16109046521.42,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_2,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.02,timestamp=16109046522.01,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_3,group=tp,comm_func=allreduce'])
rank:2:loss_func(stage_id=1,batch_id=0,mg_state=steady,duration=0.55,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=16109046523.19,sub_operations=['trace_src_func=allreduce,duration=0.1,timestamp=16109046523.03,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:2:backward_step(stage_id=1,batch_id=0,mg_state=steady,duration=274.14,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=16109046797.49,sub_operations=['trace_src_func=embedding_bwd_async,duration=2.48,timestamp=16109046529.82,input__shape=[4096, 1, 5120],input__dtype=torch.float16,func_name=embedding_bwd_async,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046537.5,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046543.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046550.87,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046556.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046564.23,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046570.01,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046577.54,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046583.32,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046590.85,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046596.62,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046604.19,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046609.96,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046617.5,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046623.27,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046630.81,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046636.58,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046644.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046649.9,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046657.44,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046663.2,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046670.75,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046676.54,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046684.08,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046689.85,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046697.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046703.17,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046710.72,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.41,timestamp=16109046716.66,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046724.22,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.31,timestamp=16109046730.05,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046737.65,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046743.42,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.08,timestamp=16109046750.89,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.29,timestamp=16109046756.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.08,timestamp=16109046764.14,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.29,timestamp=16109046769.91,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046777.46,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.28,timestamp=16109046783.23,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=2.11,timestamp=16109046790.8,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=normlinear_bwd_async,duration=1.29,timestamp=16109046796.6,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce'])
rank:2:send_backward(stage_id=1,batch_id=0,mg_state=steady,duration=0.47,description=None,group_kind=pp,input__shape=[4096, 1, 5120],input__dtype=torch.float16,timestamp=16109046798.25,sub_operations=[])
rank:2:dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=7.74,description=model_chunk.finish_grad_sync(), All-reduce / reduce-scatter across DP replicas,group_kind=dp,input__shape=[3254707200],input__dtype=torch.float16,timestamp=16109046806.07,sub_operations=[])
rank:2:ep_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=271.1,description=_allreduce_word_embedding_grads,group_kind=ep,input__shape=[16000, 5120],input__dtype=torch.float16,timestamp=16109047077.33,sub_operations=[])
rank:2:optimizer_step(stage_id=1,batch_id=0,mg_state=finalize,duration=107.26,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=16109047185.84,sub_operations=[])
