rank:3:get_batch(stage_id=1,batch_id=0,mg_state=None,duration=0.48,description=None,group_kind=tp,input__shape=None,input__dtype=None,timestamp=11408278156.09,sub_operations=['trace_src_func=_broadcast,duration=0.0,timestamp=11408278155.86,input__shape=[1, 4096],input__dtype=torch.int64,func_name=labels,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.01,timestamp=11408278155.97,input__shape=[1, 4096],input__dtype=torch.float32,func_name=loss_mask,group=tp,comm_func=broadcast', 'trace_src_func=_broadcast,duration=0.01,timestamp=11408278156.05,input__shape=[1, 1, 4096, 4096],input__dtype=torch.bool,func_name=attention_mask,group=tp,comm_func=broadcast'])
rank:3:forward_step(stage_id=1,batch_id=0,mg_state=None,duration=139.91,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11408278296.08,sub_operations=['trace_src_func=allreduce,duration=0.0,timestamp=11408278159.15,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278162.89,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278165.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278169.41,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278172.28,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278175.9,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278178.78,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278182.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278185.32,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278188.94,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278191.82,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278195.45,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278198.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278201.94,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278204.81,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278208.49,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278211.47,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278215.17,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278218.14,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278221.83,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278224.79,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278228.49,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278231.43,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278235.12,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278238.1,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278241.8,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278244.85,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278248.66,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278251.62,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278255.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278258.3,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278262.0,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278264.97,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278268.67,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278271.63,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278275.35,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278278.32,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278282.03,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278285.02,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278288.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=linear_fwd,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.0,timestamp=11408278293.85,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_1,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.0,timestamp=11408278294.53,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_2,group=tp,comm_func=allreduce', 'trace_src_func=_reduce,duration=0.0,timestamp=11408278295.35,input__shape=[4096, 1],input__dtype=torch.float32,func_name=crossEntropy_fwd_3,group=tp,comm_func=allreduce'])
rank:3:loss_func(stage_id=1,batch_id=0,mg_state=None,duration=0.38,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=11408278296.54,sub_operations=['trace_src_func=allreduce,duration=0.01,timestamp=11408278296.42,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:3:backward_step(stage_id=1,batch_id=0,mg_state=None,duration=255.64,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11408278552.33,sub_operations=['trace_src_func=allreduce,duration=0.0,timestamp=11408278302.41,input__shape=[4096, 1, 5120],input__dtype=torch.float16,func_name=embedding_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278311.73,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278317.7,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278324.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278330.33,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278337.0,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278342.96,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278349.62,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278355.58,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278362.23,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278368.13,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278374.61,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278380.4,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278386.87,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278392.65,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278399.12,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278404.91,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278411.37,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278417.16,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278423.63,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278429.41,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278435.82,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278441.55,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278447.97,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278453.7,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278460.11,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278465.84,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278472.25,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278477.98,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278484.39,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278490.12,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278496.52,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278502.22,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278508.6,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278514.3,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278520.68,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278526.39,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278532.78,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278538.48,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278544.85,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce', 'trace_src_func=allreduce,duration=0.0,timestamp=11408278550.55,input__shape=[4096, 5120],input__dtype=torch.float16,func_name=normlinear_bwd,group=tp,comm_func=allreduce'])
rank:3:dp_allreduce(stage_id=1,batch_id=0,mg_state=None,duration=0,description=None,group_kind=dp,input__shape=[3275489280],input__dtype=torch.float16,timestamp=0,sub_operations=[])
rank:3:ep_allreduce(stage_id=1,batch_id=0,mg_state=None,duration=0,description=None,group_kind=ep,input__shape=[25152, 5120],input__dtype=torch.float16,timestamp=0,sub_operations=[])
rank:3:optimizer_step(stage_id=1,batch_id=0,mg_state=None,duration=56.95,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=11408278609.43,sub_operations=[])
